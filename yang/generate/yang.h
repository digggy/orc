
#ifndef _YANG_H
#define _YANG_H
#include <stddef.h>
#include <json-c/json.h>
#include <string.h>

typedef struct map_str2str{
  char *key;
  char *str;
} map_str2str;

static const map_str2str modulemap[] = {
    {"openwrt-network", "{\"type\": \"module\", \"map\": {\"globals\": {\"type\": \"container\", \"map\": {\"ula_prefix\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"ula_prefix\", \"leaf-type\": \"inet:ipv6-prefix\"}}, \"section\": \"globals\", \"section-name\": \"globals\"}, \"interfaces\": {\"type\": \"container\", \"map\": {\"interface\": {\"type\": \"list\", \"map\": {\"ifname\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"ifname\", \"leaf-type\": \"string\", \"mandatory\": true}, \"iftype\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"type\", \"leaf-type\": \"string\"}, \"stp\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"stp\", \"leaf-type\": \"openwrt-bool\"}, \"bridge_empty\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"bridge_empty\", \"leaf-type\": \"openwrt-bool\"}, \"igmp_snooping\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"imgp_snooping\", \"leaf-type\": \"openwrt-bool\"}, \"multicast_querier\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"multicast_querier\", \"leaf-type\": \"openwrt-bool\"}, \"macaddr\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"macaddr\", \"leaf-type\": \"yang:phys-address\"}, \"mtu\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"mtu\", \"leaf-type\": \"int64\"}, \"auto\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"auto\", \"leaf-type\": \"openwrt-bool\"}, \"ipv6\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"ipv6\", \"leaf-type\": \"openwrt-bool\"}, \"force_link\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"force_link\", \"leaf-type\": \"openwrt-bool\"}, \"disabled\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"disabled\", \"leaf-type\": \"openwrt-bool\"}, \"ip4table\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"ip4table\", \"leaf-type\": \"string\"}, \"ip6table\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"ip6table\", \"leaf-type\": \"string\"}, \"proto\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"proto\", \"leaf-type\": \"string\"}, \"ipaddr\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"ipaddr\", \"leaf-type\": \"inet:ipv4-address\"}, \"netmask\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"netmask\", \"leaf-type\": \"inet:ipv4-prefix\"}, \"gateway\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"gateway\", \"leaf-type\": \"inet:ipv4-address\"}, \"broadcast\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"broadcast\", \"leaf-type\": \"inet:ipv4-address\"}, \"ip6addr\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"ip6addr\", \"leaf-type\": \"inet:ipv6-address\"}, \"ip6gw\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"ip6gw\", \"leaf-type\": \"inet:ipv6-address\"}, \"layer\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"layer\", \"leaf-type\": {\"leaf-type\": \"uint8\", \"from\": \"1\", \"to\": \"3\"}}, \"dns\": {\"type\": \"leaf-list\", \"map\": {}, \"option\": \"dns\", \"leaf-type\": \"inet:ipv4-address\"}}, \"section\": \"interface\", \"keys\": [\"ifname\"], \"mandatory\": [\"ifname\"]}}}, \"rules\": {\"type\": \"container\", \"map\": {\"ip4rules\": {\"type\": \"list\", \"map\": {\"mark\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"mark\", \"leaf-type\": \"string\"}, \"in\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"in\", \"leaf-type\": \"string\"}, \"out\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"out\", \"leaf-type\": \"string\"}, \"src\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"src\", \"leaf-type\": \"inet:ipv4-prefix\"}, \"dest\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"dest\", \"leaf-type\": \"inet:ipv4-prefix\"}, \"tos\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"tos\", \"leaf-type\": \"uint64\"}, \"invert\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"invert\", \"leaf-type\": \"openwrt-bool\"}, \"priority\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"priority\", \"leaf-type\": \"uint64\"}, \"lookup\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"lookup\", \"leaf-type\": \"string\"}, \"goto\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"goto\", \"leaf-type\": \"uint64\"}, \"action\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"action\", \"leaf-type\": \"string\"}}, \"section\": \"rule\", \"keys\": [\"mark\"]}, \"ip6rules\": {\"type\": \"list\", \"map\": {\"mark\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"mark\", \"leaf-type\": \"string\"}, \"in\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"in\", \"leaf-type\": \"string\"}, \"out\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"out\", \"leaf-type\": \"string\"}, \"src\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"src\", \"leaf-type\": \"inet:ipv6-prefix\"}, \"dest\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"dest\", \"leaf-type\": \"inet:ipv6-prefix\"}, \"tos\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"tos\", \"leaf-type\": \"uint64\"}, \"invert\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"invert\", \"leaf-type\": \"openwrt-bool\"}, \"priority\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"priority\", \"leaf-type\": \"uint64\"}, \"lookup\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"lookup\", \"leaf-type\": \"string\"}, \"goto\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"goto\", \"leaf-type\": \"uint64\"}, \"action\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"action\", \"leaf-type\": \"string\"}}, \"section\": \"rule\", \"keys\": [\"mark\"]}}}, \"routes\": {\"type\": \"container\", \"map\": {\"ip4routes\": {\"type\": \"list\", \"map\": {\"name\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"name\", \"leaf-type\": \"string\"}, \"interface\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"interface\", \"leaf-type\": \"string\", \"mandatory\": true}, \"target\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"target\", \"leaf-type\": \"inet:ipv4-address\"}, \"netmask\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"netmask\", \"leaf-type\": \"inet:ipv4-prefix\"}, \"gateway\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"gateway\", \"leaf-type\": \"inet:ipv4-address\"}, \"metric\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"metric\", \"leaf-type\": \"uint64\"}, \"mtu\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"mtu\", \"leaf-type\": \"uint64\"}, \"table\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"table\", \"leaf-type\": \"string\"}, \"source\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"source\", \"leaf-type\": \"inet:ipv4-address\"}, \"onlink\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"onlink\", \"leaf-type\": \"openwrt-bool\"}, \"rtype\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"type\", \"leaf-type\": \"string\"}}, \"section\": \"route\", \"keys\": [\"name\"], \"mandatory\": [\"interface\"]}, \"ip6routes\": {\"type\": \"list\", \"map\": {\"name\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"name\", \"leaf-type\": \"string\"}, \"interface\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"interface\", \"leaf-type\": \"string\", \"mandatory\": true}, \"target\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"target\", \"leaf-type\": \"inet:ipv6-address\"}, \"gateway\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"gateway\", \"leaf-type\": \"inet:ipv6-address\"}, \"metric\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"metric\", \"leaf-type\": \"uint64\"}, \"mtu\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"mtu\", \"leaf-type\": \"uint64\"}, \"table\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"table\", \"leaf-type\": \"string\"}, \"source\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"source\", \"leaf-type\": \"inet:ipv4-address\"}, \"onlink\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"onlink\", \"leaf-type\": \"openwrt-bool\"}, \"rtype\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"type\", \"leaf-type\": \"string\"}}, \"section\": \"route6\", \"keys\": [\"name\"], \"mandatory\": [\"interface\"]}}}, \"switches\": {\"type\": \"container\", \"map\": {\"switch\": {\"type\": \"list\", \"map\": {\"name\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"name\", \"leaf-type\": \"string\"}, \"reset\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"reset\", \"leaf-type\": \"openwrt-bool\"}, \"enable_vlan\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"enable_vlan\", \"leaf-type\": \"openwrt-bool\"}, \"enable_mirror_rx\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"enable_mirror_rx\", \"leaf-type\": \"openwrt-bool\"}, \"enable_mirror_tx\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"enable_mirror_tx\", \"leaf-type\": \"openwrt-bool\"}, \"mirror_monitor_port\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"mirror_monitor_port\", \"leaf-type\": \"uint64\"}, \"mirror_source_port\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"mirror_source_port\", \"leaf-type\": \"uint64\"}, \"arl_age_time\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"arl_age_time\", \"leaf-type\": \"uint64\"}, \"igmp_snooping\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"igmp_snooping\", \"leaf-type\": \"openwrt-bool\"}, \"igmp_v3\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"igmp_v3\", \"leaf-type\": \"openwrt-bool\"}}, \"section\": \"switch\", \"keys\": [\"name\"]}, \"switch_vlan\": {\"type\": \"list\", \"map\": {\"device\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"device\", \"leaf-type\": \"string\"}, \"vlan\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"vlan\", \"leaf-type\": \"uint64\"}, \"vid\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"vid\", \"leaf-type\": \"uint64\"}, \"ports\": {\"type\": \"leaf-list\", \"map\": {}, \"option\": \"ports\", \"leaf-type\": \"string\"}}, \"section\": \"switch_vlan\", \"keys\": [\"device\", \"vlan\"]}, \"switch_port\": {\"type\": \"list\", \"map\": {\"device\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"device\", \"leaf-type\": \"string\"}, \"port\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"port\", \"leaf-type\": \"uint64\"}, \"pvid\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"pvid\", \"leaf-type\": \"uint64\"}, \"enable_eee\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"enable_eee\", \"leaf-type\": \"openwrt-bool\"}, \"igmp_snooping\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"igmp_snooping\", \"leaf-type\": \"openwrt-bool\"}, \"igmp_v3\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"igmp_v3\", \"leaf-type\": \"openwrt-bool\"}}, \"section\": \"switch_port\", \"keys\": [\"device\", \"port\"]}}}}, \"package\": \"network\"}"},
    {"openwrt-system", "{\"type\": \"module\", \"map\": {\"system\": {\"type\": \"container\", \"map\": {\"hostname\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"hostname\", \"leaf-type\": \"string\"}, \"buffersize\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"buffersize\", \"leaf-type\": \"uint32\"}, \"conloglevel\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"conloglevel\", \"leaf-type\": {\"leaf-type\": \"uint8\", \"from\": \"0\", \"to\": \"7\"}}, \"cronloglevel\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"cronloglevel\", \"leaf-type\": \"uint8\"}, \"klogconloglevel\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"klogconloglevel\", \"leaf-type\": \"uint8\"}, \"log_buffer_size\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"lof_buffer_size\", \"leaf-type\": \"uint32\"}, \"log_file\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"log_file\", \"leaf-type\": \"string\"}, \"log_hostname\": {\"type\": \"leaf\", \"map\": {}, \"leaf-type\": \"string\"}, \"log_ip\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"log_ip\", \"leaf-type\": \"inet:ipv4-address\"}, \"log_port\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"log_port\", \"leaf-type\": \"uint32\"}, \"log_prefix\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"log_prefix\", \"leaf-type\": \"string\"}, \"log_proto\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"log_proto\", \"leaf-type\": {\"leaf-type\": \"string\", \"pattern\": \"^(udp|tcp)$\"}}, \"log_remote\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"log_remote\", \"leaf-type\": \"boolean\"}, \"log_size\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"log_size\", \"leaf-type\": \"uint32\"}, \"log_trailer_null\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"log_trailer_null\", \"leaf-type\": \"boolean\"}, \"log_type\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"log_type\", \"leaf-type\": {\"leaf-type\": \"string\", \"pattern\": \"^(circular|file)$\"}}, \"urandom_seed\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"urandom_seed\", \"leaf-type\": \"string\"}, \"timezone\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"timezone\", \"leaf-type\": \"string\"}, \"zonename\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"zonename\", \"leaf-type\": \"string\"}}, \"section-name\": \"OpenWrt\", \"section\": \"system\"}, \"ntp\": {\"type\": \"container\", \"map\": {\"enabled\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"enabled\", \"leaf-type\": {\"leaf-type\": \"string\", \"pattern\": \"^(0|1)$\"}}, \"enable_server\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"enable_server\", \"leaf-type\": {\"leaf-type\": \"string\", \"pattern\": \"^(0|1)$\"}}, \"server\": {\"type\": \"leaf-list\", \"map\": {}, \"option\": \"server\", \"leaf-type\": \"string\"}}, \"section\": \"timeserver\", \"section-name\": \"ntp\"}}, \"package\": \"system\"}"},
    {"openwrt-uci-extension", "{\"type\": \"module\", \"map\": {}}"},
    {"restconf-example", "{\"type\": \"module\", \"map\": {\"course\": {\"type\": \"container\", \"map\": {\"name\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"name\", \"leaf-type\": \"string\"}, \"semester\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"semester\", \"leaf-type\": {\"leaf-type\": \"uint8\", \"from\": \"1\", \"to\": \"6\"}}, \"instructors\": {\"type\": \"leaf-list\", \"map\": {}, \"option\": \"instructors\", \"leaf-type\": \"string\"}, \"students\": {\"type\": \"list\", \"map\": {\"firstname\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"firstname\", \"leaf-type\": \"string\"}, \"lastname\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"lastname\", \"leaf-type\": \"string\"}, \"age\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"age\", \"leaf-type\": {\"leaf-type\": \"uint8\", \"from\": \"0\", \"to\": \"120\"}}, \"major\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"major\", \"leaf-type\": {\"leaf-type\": \"string\", \"pattern\": \"^(CS|IMS)$\"}}, \"grade\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"grade\", \"leaf-type\": \"grade\"}}, \"section\": \"student\", \"leaf-as-name\": \"lastname\", \"keys\": [\"firstname\", \"lastname\", \"age\"]}, \"instructor\": {\"type\": \"container\", \"map\": {\"name\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"name\", \"leaf-type\": \"string\"}, \"email\": {\"type\": \"leaf\", \"map\": {}, \"option\": \"email\", \"leaf-type\": \"email\"}}, \"section-name\": \"instructor\", \"section\": \"instructor\"}}, \"section-name\": \"course\", \"section\": \"course\"}}, \"package\": \"restconf-example\"}"}
};

static const map_str2str yang2regex[] = {
    {"openwrt-bool", "{\"leaf-type\": \"string\", \"pattern\": \"^(0|1)$\"}"},
    {"grade", "{\"leaf-type\": \"uint8\", \"from\": \"0\", \"to\": \"100\"}"},
    {"email", "{\"leaf-type\": \"string\", \"pattern\": \"^[A-Za-z0-9]*@university.de$\"}"}
};

typedef enum yang_type {
  NONE,
  BINARY,
  BITS,
  BOOLEAN,
  DECIMAL_64,
  EMPTY,
  ENUMERATION,
  IDENTITY_REF,
  INSTANCE_IDENTIFIER,
  INT_8,
  INT_16,
  INT_32,
  INT_64,
  LEAF_REF,
  STRING,
  UINT_8,
  UINT_16,
  UINT_32,
  UINT_64,
  UNION
} yang_type;

struct map_str2yang_type {
  char* str;
  yang_type type;
};
typedef struct map_str2yang_type map_str2yang_type;

static const map_str2yang_type str2yang_type[] = {
    {"string", STRING},
    {"int8", INT_8},
    {"int16", INT_16},
    {"int32", INT_32},
    {"int64", INT_64},
    {"uint8", UINT_8},
    {"uint16", UINT_16},
    {"uint32", UINT_32},
    {"uint64", UINT_64},
    {"binary", BINARY},
    {"boolean", BOOLEAN},
    {"decimal64", DECIMAL_64}
};

struct json_object* yang_module_exists(char* module);
yang_type str_to_yang_type(const char* str);
const char* yang_for_type(const char* type);

#endif