---

test_name: Get operations and initializations

includes:
  - !include common.yaml

stages:
  - name: Get all operations
    request:
      url: "{url}/operations/"
      method: GET
      headers:
        content-type: application/yang-data+json
        accept: application/yang-data+json
    response:
      status_code:
        - 200
      json:
        'openwrt-restconf:operations':
          'openwrt-system-operations:copy': '/restconf/operations/openwrt-system-operations:copy'
          'openwrt-system-operations:delete': '/restconf/operations/openwrt-system-operations:delete'
          'openwrt-system-operations:reboot': '/restconf/operations/openwrt-system-operations:reboot'
          'openwrt-system-operations:opkg': '/restconf/operations/openwrt-system-operations:opkg'
          'openwrt-measurement-operations:free': '/restconf/operations/openwrt-measurement-operations:free'
          'openwrt-measurement-operations:mtr': '/restconf/operations/openwrt-measurement-operations:mtr'
          'openwrt-measurement-operations:ping': '/restconf/operations/openwrt-measurement-operations:ping'



---

test_name: POST tests on mtr

strict:
  - headers:off
  - json:off

includes:
  - !include common.yaml

stages:
  - name: with valid-mtr
    request:
      url: "{url}/operations/openwrt-measurement-operations:mtr"
      method: POST
      headers:
        content-type: application/yang-data+json
        accept: application/yang-data+json
      json:
        !include POST/OPERATIONS/valid-mtr.yaml
    response:
      !include POST/OPERATIONS/mtr-response.yaml

  - name: check with defaults
    request:
      url: "{url}/operations/openwrt-measurement-operations:mtr"
      method: POST
      headers:
        content-type: application/yang-data+json
        accept: application/yang-data+json
      json:
        destination: 'google.com'
    response:
      !include POST/OPERATIONS/mtr-response.yaml

#  - name: check with invalid type
#    request:
#      url: "{url}/operations/openwrt-measurement-operations:mtr"
#      method: POST
#      headers:
#        content-type: application/yang-data+json
#        accept: application/yang-data+json
#      json:
#        'destination': 1
#    response:
#      # Need to write
#
#  - name: check with empty request
#    request:
#      url: "{url}/operations/openwrt-measurement-operations:mtr"
#      method: POST
#      headers:
#        content-type: application/yang-data+json
#        accept: application/yang-data+json
#      json:
#        'destination': 1
#    response:
#    # Need to write
#
#  - name: check with
#    request:
#      url: "{url}/operations/openwrt-measurement-operations:mtr"
#      method: POST
#      headers:
#        content-type: application/yang-data+json
#        accept: application/yang-data+json
#      json:
#        'destination': 1
#    response:
#    # Need to write
#
#---

#test_name: POST tests on ping
#
#strict:
#  - headers:off
#  - json:off
#
#includes:
#  - !include common.yaml
#
#stages:
#  - name: POST test on mtr
#    request:
#      url: "{url}/operations/openwrt-measurement-operations:ping"
#      method: POST
#      headers:
#        content-type: application/yang-data+json
#        accept: application/yang-data+json
#      json:
#        !include POST/OPERATIONS/valid-ping.yaml
#    response:
#      !include POST/OPERATIONS/ping-response.yaml


# test_name: Check for methods allowed on endpoints

# strict:
#   - headers:off
#   - json:off

# includes:
#   - !include common.yaml

# stages:
#   - name: POST on operations root
#     request:
#       url: "{url}/operations/"
#       method: POST
#       headers:
#         content-type: application/yang-data+json
#         accept: application/yang-data+json
#     response:
#       status_code:
#         - 405
  
#   - name: OPTIONS on operations root
#     request:
#       url: "{url}/operations/"
#       method: OPTIONS
#       headers:
#         content-type: application/yang-data+json
#         accept: application/yang-data+json
#     response:
#       headers:
#         allow: OPTIONS, GET, HEAD
#       status_code:
#         - 200

#   - name: OPTIONS on data/ endpoints
#     request:
#       url: "{url}/data/restconf-example:course"
#       method: OPTIONS
#       headers:
#         content-type: application/yang-data+json
#         accept: application/yang-data+json
#     response:
#       headers:
#         allow: DELETE, GET, HEAD, PATCH, POST, PUT, OPTIONS
#       status_code:
#         - 200

#   - name: "OPTIONS on mtr endpoints"
#     request:
#       url: "{url}/operations/openwrt-measurement-operations:mtr"
#       method: OPTIONS
#       headers:
#         content-type: application/yang-data+json
#         accept: application/yang-data+json
#     response:
#       headers:
#         allow: OPTIONS, POST
#       status_code:
#         - 200

#   - name: "OPTIONS on /operations/openwrt-measurement-operations:ping endpoints"
#     request:
#       url: "{url}/operations/openwrt-operations:ping"
#       method: OPTIONS
#       headers:
#         content-type: application/yang-data+json
#         accept: application/yang-data+json
#     response:
#       headers:
#         allow: OPTIONS, POST
#       status_code:
#         - 200
  